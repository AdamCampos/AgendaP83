/* Grid.css — somente grid (scroll, sticky, meses, códigos, weekend, drag)
   FIX: coluna Função (sticky-left) não “anda” no scroll (bug do sticky + flex no TD)
   FIX: separação de camadas + month band + freeze pane
*/

/* ===== Grid wrapper ===== */
.grid-wrap{
    overflow:auto;
    height:100%;
    background:#fff;
  
    scrollbar-gutter: stable both-edges;
  
    /* cria stacking context próprio */
    position: relative;
    z-index: 0;
    isolation: isolate;
  }
  
  /* “gutter real” para scrollbar overlay não cobrir células */
  .grid-inner{
    display:inline-block;
    padding-right: 18px;
    padding-bottom: 18px;
  }
  
  table.grid{
    border-collapse:collapse;
    table-layout: fixed;
    width:max-content;
    min-width: 1200px;
    font-size:12px;
  
    position: relative;
    z-index: 0;
  }
  
  .grid th, .grid td{
    border:1px solid var(--grid-border);
    padding:0;
    height:22px;
    text-align:center;
    vertical-align:middle;
    white-space:nowrap;
    font-size:12px;
    line-height:1;
  
    /* ajuda sticky em alguns cenários */
    background-clip: padding-box;
  }
  
  /* ===== Cabeçalhos sticky ===== */
  .grid thead th{
    position: sticky;
    top: 0;
    z-index: 30;
    background: var(--head);
    font-weight:800;
  }
  
  .grid thead tr:nth-child(2) th{
    position: sticky;
    top: 22px;
    background: var(--head2);
    z-index: 29;
    font-weight:700;
  }
  
  /* Larguras */
  .col-funcao{ width:var(--w-funcao); text-align:left; padding-left:8px; }
  .col-matricula{ width:var(--w-matricula); }
  .col-nome{ width:var(--w-nome); text-align:left; padding-left:8px; }
  .col-chave{ width:var(--w-chave); font-weight:900; }
  .col-quant{ width:var(--w-quant); }
  
  .day-header{ width:24px; font-weight:900; }
  .day{ width:24px; font-weight:900; }
  .day.empty{ color:#9ca3af; font-weight:500; }
  
  /* Weekend não sobrepõe códigos */
  .day-header.weekend{ background: var(--weekend) !important; }
  .day.weekend.empty{ background: var(--weekend) !important; }
  
  /* ===== Sticky columns (congelar painel) =====
     IMPORTANTE: o TD sticky NÃO pode ter display:flex (bug).
     O flex fica em um wrapper interno (div.drag-handle-cell).
  */
  .grid tbody .sticky-left,
  .grid tbody .sticky-left2,
  .grid tbody .sticky-left3,
  .grid tbody .sticky-left4,
  .grid tbody .sticky-left5{
    position: sticky;
    background:#fff;
    z-index: 20;
    box-shadow: none;
  
    /* garante que a célula pinte por cima do conteúdo rolável */
    background-clip: padding-box;
  }
  
  /* Cabeçalho (canto superior esquerdo) */
  .grid thead .sticky-left,
  .grid thead .sticky-left2,
  .grid thead .sticky-left3,
  .grid thead .sticky-left4,
  .grid thead .sticky-left5{
    position: sticky;
    background: var(--head);
    z-index: 40;
    box-shadow: none;
  
    background-clip: padding-box;
  }
  
  /* offsets */
  .sticky-left{ left:0; }
  .sticky-left2{ left:var(--w-funcao); }
  .sticky-left3{ left:calc(var(--w-funcao) + var(--w-matricula)); }
  .sticky-left4{ left:calc(var(--w-funcao) + var(--w-matricula) + var(--w-nome)); }
  .sticky-left5{ left:calc(var(--w-funcao) + var(--w-matricula) + var(--w-nome) + var(--w-chave)); }
  
  /* Freeze pane: sombra só na última coluna fixa */
  .grid tbody .sticky-left5{ box-shadow: var(--sticky-shadow); }
  .grid thead .sticky-left5{ box-shadow: var(--sticky-shadow); }
  
  /* ===== Meses ===== */
  .month-band{
    background:#e5e7eb !important;
    font-weight:900;
    text-transform:lowercase;
    letter-spacing:.3px;
    border-left: var(--month-sep-w) solid var(--month-sep) !important;
    border-right: var(--month-sep-w) solid var(--month-sep) !important;
  
    /* acima do header normal, abaixo do canto congelado */
    z-index: 35;
  }
  
  .day-header.month-start{
    border-left: var(--month-sep-w) solid var(--month-sep) !important;
  }
  .day.month-start{
    border-left: var(--month-sep-w) solid var(--month-sep) !important;
  }
  
  /* ===== Drag handle =====
     ✅ NÃO aplique display:flex no TD sticky.
     O flex deve estar em um wrapper interno dentro da célula Função.
  */
  .drag-handle-cell{
    display:flex;
    align-items:center;
    gap:8px;
  
    /* como antes era padding-left no td, mantemos aqui também */
    padding-left:8px;
    padding-right:8px;
  
    /* evita overflow visual */
    min-width: 0;
  }
  
  .funcao-text{
    min-width: 0;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }
  
  .drag-handle{
    display:inline-flex;
    width:20px;
    height:20px;
    align-items:center;
    justify-content:center;
    border:1px solid var(--grid-border);
    border-radius:6px;
    background:#fff;
    cursor:grab;
    user-select:none;
    flex: 0 0 auto;
  }
  .drag-handle:active{ cursor:grabbing; }
  
  tr[data-dragging="1"] td{
    box-shadow: 0 8px 20px rgba(17,24,39,0.12);
  }
  
  /* ===== Exclusão local ===== */
  .day.deleted{
    opacity:.25;
    text-decoration: line-through;
    filter: grayscale(.3);
  }
  
  /* ===== Cores (suas cores originais) ===== */
  .code-FS{ background:#a3e635 !important; }
  .code-F{ background:#fde047 !important; }
  .code-HO{ background:#38bdf8 !important; }
  .code-B{ background:#22c55e !important; }
  .code-YNT{ background:#f59e0b !important; }
  .code-V{ background:#e5e7eb !important; }
  .code-EM{ background:#c7d2fe !important; }
  .code-ANG{ background:#fca5a5 !important; }
  .code-TR{ background:#fecaca !important; }
  .code-NTG{ background:#fb7185 !important; color:#111827 !important; }
  .code-SGP{ background:#fca5a5 !important; } /* ajuste conforme sua planilha */
  .code-TUY{ background:#e5e7eb !important; }
  
  /* Legenda herda cor */
  .tag.code-FS,.tag.code-F,.tag.code-HO,.tag.code-B,.tag.code-YNT,.tag.code-V,.tag.code-EM,.tag.code-ANG,
  .tag.code-TR,.tag.code-NTG,.tag.code-SGP,.tag.code-TUY{
    border-color: var(--grid-border);
  }
  